# 第20章（1-3）

## 20-1

1．对于线性页表，你需要一个寄存器来定位页表，假设硬件在 TLB 未命中时进行查找。

你需要多少个寄存器才能找到两级页表？三级页表呢？

答：只需要一个寄存器，其中保存页目录物理地址，根据页目录项可以找到对应的页表地址。

## 20-2

2．使用模拟器对随机种子 0、1 和 2 执行翻译，并使用-c 标志检查你的答案。需要多

少内存引用来执行每次查找？

<img src="截屏2024-04-29 下午10.02.04.png" alt="截屏2024-04-29 下午10.02.04" style="zoom:67%;" /><img src="截屏2024-04-29 下午10.11.09.png" alt="截屏2024-04-29 下午10.11.09" style="zoom:67%;" />

根据README的内容知页面大小为32字节，虚拟地址空间大小为1024页或32KB，物理内存大小为128页或2KB;

因此虚拟地址共15位，且高5位用于表示页目录索引，从高位往后每5位是多级页表的偏移量；

物理地址共11位。

### 种子0

<img src="截屏2024-04-29 下午9.58.21.png" alt="截屏2024-04-29 下午9.58.21" style="zoom:67%;" /><img src="截屏2024-04-29 下午9.58.49.png" alt="截屏2024-04-29 下午9.58.49" style="zoom:60%;" />

由题目可知页目录保存在第108页

**Virtual Address 611c: Translates To What Physical Address (And Fetches what Value)? Or Fault?**

0x611c转换成15位虚拟地址：**11000 01000 11100**

高五位索引页目录：0x11000 = **24**，在页目录中查找第24页目录项（PDE）<img src="截屏2024-04-30 上午8.51.51.png" alt="截屏2024-04-30 上午8.51.51" style="zoom:67%;" />

| Page 108 | 83   | fe   | e0   | da   | 7f   | d4   | 7f   | eb   | be   | 9e   | d5   | ad   | e4   | ac   | 90   | d6   | 92   | d8   | c1   | f8   | 9f   | e1   | ed   | e9   | a1   | e8   | c7   | c2   | a9   | d1   | db   | ff   |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index    | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第24项内容为**0xa1**： 1 0100001，最高位有效位为1，页帧号为**33**

偏移量为01000 = **8**，在page33查找第8页表项（PTE）:<img src="截屏2024-04-30 上午8.51.24.png" alt="截屏2024-04-30 上午8.51.24" style="zoom:67%;" />

| Page 33 | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | b5   | 9d   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | f6   | b1   | 7f   | 7f   | 7f   |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index   | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第8项内容为**0xb5**:1 0110101，最高位有效位为1，物理页号为**53**

偏移量为11100 = **28**，所以11位物理地址为：110101 11100，即**0x6bc**

在page53查找该物理地址内容：

<img src="截屏2024-04-30 上午8.52.30.png" alt="截屏2024-04-30 上午8.52.30" style="zoom:67%;" />

| Page 53 | 0f   | 0c   | 18   | 09   | 0e   | 12   | 1c   | 0f   | 08   | 17   | 13   | 07   | 1c   | 1e   | 19   | 1b   | 09   | 16   | 1b   | 15   | 0e   | 03   | 0d   | 12   | 1c   | 1d   | 0e   | 1a   | 08   | 18   | 11   | 00   |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index   | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第28项内容为**0x08**。

**Virtual Address 3da8: Translates To What Physical Address (And Fetches what Value)? Or Fault?**

0x3da8转换成15位虚拟地址：**01111 01101 00101**

高五位索引页目录：01111 = **15**，在页目录中查找第15页目录项（PDE）：

| Page 108 | 83   | fe   | e0   | da   | 7f   | d4   | 7f   | eb   | be   | 9e   | d5   | ad   | e4   | ac   | 90   | d6   | 92   | d8   | c1   | f8   | 9f   | e1   | ed   | e9   | a1   | e8   | c7   | c2   | a9   | d1   | db   | ff   |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index    | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第15项内容为**0xd6**：1 1010110，最高位有效位为1，页帧号为**86**

偏移量为01101 = **13**，在page86中查找第13页表项（PTE）：

<img src="截屏2024-04-30 上午9.17.05.png" alt="截屏2024-04-30 上午9.17.05" style="zoom:67%;" />

7f 7f 7f 7f 7f 7f 7f c5 7f 7f 7f 7f 7f 7f 7f 7f 7f 7f 7f 7f ca 7f 7f ee 7f 7f 7f 7f 7f 7f 7f 7f

| Page 86 | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | c5   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | ca   | 7f   | 7f   | Ee   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index   | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第13项内容为**0x7f**：0 1111111，最高位有效位为0，说明该页不是有效页，结果为**Fault**。

**Virtual Address 17f5: Translates To What Physical Address (And Fetches what Value)? Or Fault?**

0x17f5转换成15位虚拟地址：**00101 11111 10101**

高五位索引页目录：00101 = **5**，在页目录中查找第5页目录项（PDE）：

| Page 108 | 83   | fe   | e0   | da   | 7f   | d4   | 7f   | eb   | be   | 9e   | d5   | ad   | e4   | ac   | 90   | d6   | 92   | d8   | c1   | f8   | 9f   | e1   | ed   | e9   | a1   | e8   | c7   | c2   | a9   | d1   | db   | ff   |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index    | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第5项内容位**0xd4**：1 1010100，最高位有效位为1，页帧号为**84**

偏移量为11111 = **31**，在page84中查找第31页表项（PTE）：

<img src="截屏2024-04-30 上午9.30.45.png" alt="截屏2024-04-30 上午9.30.45" style="zoom:67%;" />

| Page 86 | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 94   | 7f   | 7f   | 7f   | 7f   | 7f   | ce   |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index   | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第31项内容为**0xce**：1 1001110，最高位有效位为1，页帧号为**78**

偏移量为10101 = **21**，所以11位物理地址为：101110 10101，即**0x9d5**

在page78查找该物理地址内容：

<img src="截屏2024-05-05 下午1.54.30.png" alt="截屏2024-05-05 下午1.54.30" style="zoom:67%;" />

| Page 78 | 0e   | 02   | 17   | 1b   | 1c   | 1a   | 1b   | 1c   | 10   | 0c   | 15   | 08   | 19   | 1a   | 1b   | 12   | 1d   | 11   | 0d   | 14   | 1e   | 1c   | 18   | 02   | 12   | 0f   | 13   | 1a   | 07   | 16   | 03   | 06   |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index   | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第21项内容为**0x1c**。

**Virtual Address 7f6c: Translates To What Physical Address (And Fetches what Value)? Or Fault?**

0x7f6c转换成15位虚拟地址：**11111 11011 01100**

高五位索引页目录：0x11111 = **31**，在页目录中查找第31页目录项（PDE）![截屏2024-04-30 上午8.51.51](/Users/fanglunlin/Library/Application Support/typora-user-images/截屏2024-04-30 上午8.51.51.png)

| Page 108 | 83   | fe   | e0   | da   | 7f   | d4   | 7f   | eb   | be   | 9e   | d5   | ad   | e4   | ac   | 90   | d6   | 92   | d8   | c1   | f8   | 9f   | e1   | ed   | e9   | a1   | e8   | c7   | c2   | a9   | d1   | db   | ff   |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index    | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第31项内容为**0xff**： 1 1111111，最高位有效位为1，页帧号为**127**

偏移量为11011 = **27**，在page127查找第27页表项（PTE）:<img src="截屏2024-05-05 下午2.01.56.png" alt="截屏2024-05-05 下午2.01.56" style="zoom:67%;" />

| Page 127 | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | df   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 95   | 7f   | 7f   |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index    | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第27项内容为**0x7f**:0 1111111，最高位有效位为0，说明该页不是有效页，结果为**Fault**

**Virtual Address 0bad: Translates To What Physical Address (And Fetches what Value)? Or Fault?**

0x0bad转换成15位虚拟地址：**00010 11101 01011**

高五位索引页目录：0x00010 = **2**，在页目录中查找第2页目录项（PDE）![截屏2024-04-30 上午8.51.51](/Users/fanglunlin/Library/Application Support/typora-user-images/截屏2024-04-30 上午8.51.51.png)

| Page 108 | 83   | fe   | e0   | da   | 7f   | d4   | 7f   | eb   | be   | 9e   | d5   | ad   | e4   | ac   | 90   | d6   | 92   | d8   | c1   | f8   | 9f   | e1   | ed   | e9   | a1   | e8   | c7   | c2   | a9   | d1   | db   | ff   |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index    | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第2项内容为**0xe0**： 1 1100000，最高位有效位为1，页帧号为**96**

偏移量为11101 = **29**，在page96查找第29页表项（PTE）:<img src="截屏2024-05-05 下午2.08.19.png" alt="截屏2024-05-05 下午2.08.19" style="zoom:67%;" />

| Page 96 | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | b6   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index   | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第29项内容为**0x7f**:0 1111111，最高位有效位为0，说明该页不是有效页，结果为**Fault**

**Virtual Address 6d60: Translates To What Physical Address (And Fetches what Value)? Or Fault?**

0x6d60转换成15位虚拟地址：**11011 01011 00000**

高五位索引页目录：0x11011 = **27**，在页目录中查找第27页目录项（PDE）![截屏2024-04-30 上午8.51.51](/Users/fanglunlin/Library/Application Support/typora-user-images/截屏2024-04-30 上午8.51.51.png)

| Page 108 | 83   | fe   | e0   | da   | 7f   | d4   | 7f   | eb   | be   | 9e   | d5   | ad   | e4   | ac   | 90   | d6   | 92   | d8   | c1   | f8   | 9f   | e1   | ed   | e9   | a1   | e8   | c7   | c2   | a9   | d1   | db   | ff   |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index    | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第27项内容为**0xc2**： 1 1000010，最高位有效位为1，页帧号为**66**

偏移量为01011 = **11**，在page66查找第11页表项（PTE）:<img src="截屏2024-05-05 下午2.21.12.png" alt="截屏2024-05-05 下午2.21.12" style="zoom:67%;" />

| Page 66 | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | d7   | 7f   | 7f   |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index   | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第11项内容为**0x7f**:0 1111111，最高位有效位为0，说明该页不是有效页，结果为**Fault**

**Virtual Address 2a5b: Translates To What Physical Address (And Fetches what Value)? Or Fault?**

0x2a5b转换成15位虚拟地址：**01010 10010 11011**

高五位索引页目录：0x01010 = **10**，在页目录中查找第10页目录项（PDE）![截屏2024-04-30 上午8.51.51](/Users/fanglunlin/Library/Application Support/typora-user-images/截屏2024-04-30 上午8.51.51.png)

| Page 108 | 83   | fe   | e0   | da   | 7f   | d4   | 7f   | eb   | be   | 9e   | d5   | ad   | e4   | ac   | 90   | d6   | 92   | d8   | c1   | f8   | 9f   | e1   | ed   | e9   | a1   | e8   | c7   | c2   | a9   | d1   | db   | ff   |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index    | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第27项内容为**0xd5**： 1 1010101，最高位有效位为1，页帧号为**85**

偏移量为10010 = **18**，在page85查找第18页表项（PTE）:<img src="截屏2024-05-05 下午2.26.19.png" alt="截屏2024-05-05 下午2.26.19" style="zoom:67%;" />

| Page 85 | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 9a   | 7f   | bf   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | af   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index   | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第18项内容为**0x7f**:0 1111111，最高位有效位为0，说明该页不是有效页，结果为**Fault**

**Virtual Address 4c5e: Translates To What Physical Address (And Fetches what Value)? Or Fault?**

0x4c5e转换成15位虚拟地址：**10011 00010 11110**

高五位索引页目录：0x10011 = **19**，在页目录中查找第19页目录项（PDE）![截屏2024-04-30 上午8.51.51](/Users/fanglunlin/Library/Application Support/typora-user-images/截屏2024-04-30 上午8.51.51.png)

| Page 108 | 83   | fe   | e0   | da   | 7f   | d4   | 7f   | eb   | be   | 9e   | d5   | ad   | e4   | ac   | 90   | d6   | 92   | d8   | c1   | f8   | 9f   | e1   | ed   | e9   | a1   | e8   | c7   | c2   | a9   | d1   | db   | ff   |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index    | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第19项内容为**0xf8**： 1 1111000，最高位有效位为1，页帧号为**120**

偏移量为00010 = **2**，在page120查找第2页表项（PTE）:<img src="截屏2024-05-05 下午2.31.45.png" alt="截屏2024-05-05 下午2.31.45" style="zoom:67%;" />

| Page 120 | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | cb   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index    | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第2项内容为**0x7f**:0 1111111，最高位有效位为0，说明该页不是有效页，结果为**Fault**

**Virtual Address 2592: Translates To What Physical Address (And Fetches what Value)? Or Fault?**

0x2592转换成15位虚拟地址：**01001 01100 10010**

高五位索引页目录：01001 = **9**，在页目录中查找第9页目录项（PDE）：

| Page 108 | 83   | fe   | e0   | da   | 7f   | d4   | 7f   | eb   | be   | 9e   | d5   | ad   | e4   | ac   | 90   | d6   | 92   | d8   | c1   | f8   | 9f   | e1   | ed   | e9   | a1   | e8   | c7   | c2   | a9   | d1   | db   | ff   |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index    | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第5项内容位**0x9e**：1 0011110，最高位有效位为1，页帧号为**30**

偏移量为01100 = **12**，在page30中查找第12页表项（PTE）：<img src="截屏2024-05-05 下午3.01.45.png" alt="截屏2024-05-05 下午3.01.45" style="zoom:67%;" />

| Page 30 | 7f   | 7f   | 7f   | 7f   | 7f   | 84   | 7f   | 7f   | 7f   | 7f   | 97   | 7f   | bd   | 7f   | 7f   | f4   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 9c   | 7f   |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index   | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第12项内容为**0xbd**：1 0111101，最高位有效位为1，页帧号为**61**

偏移量为10010 = **18**，所以11位物理地址为：111101 10010，即**0x7b2**

在page61查找该物理地址内容：

<img src="截屏2024-05-05 下午3.10.42.png" alt="截屏2024-05-05 下午3.10.42" style="zoom:67%;" />

| Page 61 | 01   | 05   | 10   | 02   | 0c   | 0a   | 0c   | 03   | 1c   | 0e   | 1a   | 1e   | 0a   | 0e   | 15   | 0d   | 09   | 16   | 1b   | 1c   | 13   | 0b   | 1e   | 13   | 02   | 02   | 17   | 01   | 00   | 0c   | 10   | 0d   |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index   | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第18项内容为**0x1b**。

**Virtual Address 3e99: Translates To What Physical Address (And Fetches what Value)? Or Fault?**

0x3e99转换成15位虚拟地址：**01111 10100 11001**

高五位索引页目录：01111 = **15**，在页目录中查找第15页目录项（PDE）：

| Page 108 | 83   | fe   | e0   | da   | 7f   | d4   | 7f   | eb   | be   | 9e   | d5   | ad   | e4   | ac   | 90   | d6   | 92   | d8   | c1   | f8   | 9f   | e1   | ed   | e9   | a1   | e8   | c7   | c2   | a9   | d1   | db   | ff   |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index    | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第15项内容位**0xd6**：1 1010110，最高位有效位为1，页帧号为**86**

偏移量为10100 = **20**，在page86中查找第20页表项（PTE）：

<img src="截屏2024-05-05 下午3.15.52.png" alt="截屏2024-05-05 下午3.15.52" style="zoom:67%;" />

| Page 86 | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | c5   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | ca   | 7f   | 7f   | ee   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   | 7f   |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index   | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第29项内容为**0xca**：1 1001010，最高位有效位为1，页帧号为**74**

偏移量为11001 = **25**，所以11位物理地址为：（1）001010 11001，即**0x959**

在page74查找该物理地址内容：<img src="截屏2024-05-05 下午3.42.46.png" alt="截屏2024-05-05 下午3.42.46" style="zoom:67%;" />

| Page 74 | 0d   | 0b   | 1e   | 08   | 18   | 0d   | 0b   | 01   | 1a   | 15   | 1b   | 0d   | 14   | 03   | 0c   | 06   | 01   | 1d   | 06   | 04   | 06   | 0b   | 10   | 04   | 1e   | 1e   | 04   | 0c   | 15   | 1b   | 0f   | 1c   |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| index   | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   | 16   | 17   | 18   | 19   | 20   | 21   | 22   | 23   | 24   | 25   | 26   | 27   | 28   | 29   | 30   | 31   |

第25项内容为**0x1e**。

### 种子1

<img src="截屏2024-04-30 上午9.04.03.png" alt="截屏2024-04-30 上午9.04.03" style="zoom:75%;" /><img src="截屏2024-04-30 上午9.04.24.png" alt="截屏2024-04-30 上午9.04.24" style="zoom:67%;" />

地址翻译方法与种子0中相同：

<img src="截屏2024-05-05 下午3.53.22.png" alt="截屏2024-05-05 下午3.53.22" style="zoom:67%;" />种子2

<img src="截屏2024-05-05 下午3.56.48.png" alt="截屏2024-05-05 下午3.56.48" style="zoom:67%;" /><img src="截屏2024-05-05 下午3.57.08.png" alt="截屏2024-05-05 下午3.57.08" style="zoom:67%;" /><img src="截屏2024-05-05 下午3.59.53.png" alt="截屏2024-05-05 下午3.59.53" style="zoom:67%;" />

可以看到要成功翻译地址，要进行3次内存查找，一次在页目录中查找，一次在页表中查找对应物理页，最后根据物理页查找物理地址中的数据。

## 20-3

3．根据你对缓存内存的工作原理的理解，你认为对页表的内存引用如何在缓存中工作？

它们是否会导致大量的缓存命中（并导致快速访问）或者很多未命中（并导致访问缓慢）？

初次访问内存中的某个位置时，会产生冷不命中，然后系统将访问页表，找到虚拟页所对应的物理页，并将这个映射保存到缓存中。当缓存中的映射越来越多后，接下来的访问很有可能导致大量的缓存命中，从而导致快速访问。

但在一些特定的情况下，程序短时间访问的页数大于缓存中的页数或是使用的页面替换算法较差时，可能会产生大量的缓存不命中。
